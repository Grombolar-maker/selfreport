# 自动每日一报

'''
所需库：bs4,requests,lxml
注意，使用前请连接校园网以保证通讯通畅
'''

import requests
from lxml import etree
import time

# UA伪装
headers = {
        'user-agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36 OPR/26.0.1656.60'
    }
# 实例化session对象
session = requests.Session()

# 通过登录页面获取cookie
pass_url = 'https://newsso.shu.edu.cn/login/eyJ0aW1lc3RhbXAiOjE2MDgyNzg0ODk1MzM1MzgyMDAsInJlc3BvbnNlVHlwZSI6ImNvZGUiLCJjbGllbnRJZCI6IldVSFdmcm50bldZSFpmelE1UXZYVUNWeSIsInNjb3BlIjoiMSIsInJlZGlyZWN0VXJpIjoiaHR0cHM6Ly9zZWxmcmVwb3J0LnNodS5lZHUuY24vTG9naW5TU08uYXNweD9SZXR1cm5Vcmw9JTJmIiwic3RhdGUiOiJwcWI4N3oifQ=='
# 设置参数
username = 123    # 学号
password = 'xxxxxxx' # 密码
data = {
    'username': username,
    'password': password,
    'login_submit': ''
}
user_page_responce = session.post(url=pass_url, headers=headers, data=data)
print(user_page_responce.status_code)

# 自动早报
# 获取__VIEWSTATE
url = 'https://selfreport.shu.edu.cn/XueSFX/HalfdayReport.aspx?t=1'     # t=1为早报， t=2为晚报
text = session.get(url=url, headers=headers).text
# with open('./selfreport.html', 'w', encoding='utf-8') as fp:
#     fp.write(text)
# 实例化etree对象
tree = etree.HTML(text)
__VIEWSTATE = tree.xpath('//div[@class="aspNetHidden"]/input[3]/@value')[0]
# 对url发起post请求以完成早报
morn_rep_url = 'https://selfreport.shu.edu.cn/XueSFX/HalfdayReport.aspx?t=1'    # t=1为早报， t=2为晚报
# 设置参数
Td_time = time.strftime('%Y-%m-%d')     # 获取今天的日期
DangQSTZK = '良好'                      # 当前身体状况
TiWen = '36.5'                          # 体温
ZaiXiao = '宝山'                        # 当天所在学校：1.不在校，2.宝山。。。
p1_XiangXDZ = '新校区校内N'             # 具体地址
morn_rep_data = {
    '__EVENTTARGET': 'p1$ctl00$btnSubmit',
    '__EVENTARGUMENT': '',
    '__VIEWSTATE': __VIEWSTATE,
    '__VIEWSTATEGENERATOR': 'DC4D08A3',
    'p1$ChengNuo': 'p1_ChengNuo',
    'p1$BaoSRQ': Td_time,
    'p1$DangQSTZK': DangQSTZK,
    'p1$TiWen': TiWen,
    'p1$ZaiXiao': ZaiXiao,
    'p1$ddlSheng$Value': '上海',
    'p1$ddlSheng': '上海',
    'p1$ddlShi$Value': '上海市',
    'p1$ddlShi': '上海市',
    'p1$ddlXian$Value': '宝山区',
    'p1$ddlXian':' 宝山区',
    'p1$FengXDQDL': '否',
    'p1$TongZWDLH': '否',
    'p1$XiangXDZ': '新校区校内N',
    'p1$QueZHZJC$Value': '否',
    'p1$QueZHZJC': '否',
    'p1$DangRGL': '否',
    'p1$GeLDZ': '',
    'p1$CengFWH': '否',
    'p1$CengFWH_RiQi': '',
    'p1$CengFWH_BeiZhu': '',
    'p1$JieChu': '否',
    'p1$JieChu_RiQi': '',
    'p1$JieChu_BeiZhu': '',
    'p1$TuJWH': '否',
    'p1$TuJWH_RiQi': '',
    'p1$TuJWH_BeiZhu': '',
    'p1$JiaRen_BeiZhu': '',
    'p1$SuiSM': '绿色',
    'p1$LvMa14Days': '是',
    'p1$Address2': '',
    'F_TARGET': 'p1_ctl00_btnSubmit',
    'p1_GeLSM_Collapsed': 'false',
    'p1_Collapsed': 'false',
    # 下面这个ID每人独有一个， 请联系喻文杰获取详情
    'F_STATE': 'eyJwMV9DaGVuZ051byI6eyJDaGVja2VkIjp0cnVlfSwicDFfQmFvU1JRIjp7IlRleHQiOiIyMDIwLTEyLTE4In0sInAxX0RhbmdRU1RaSyI6eyJGX0l0ZW1zIjpbWyLoia/lpb0iLCLoia/lpb0iLDFdLFsi5LiN6YCCIiwi5LiN6YCCIiwxXV0sIlNlbGVjdGVkVmFsdWUiOiLoia/lpb0ifSwicDFfWmhlbmdaaHVhbmciOnsiSGlkZGVuIjp0cnVlLCJGX0l0ZW1zIjpbWyLmhJ/lhpIiLCLmhJ/lhpIiLDFdLFsi5ZKz5Ze9Iiwi5ZKz5Ze9IiwxXSxbIuWPkeeDrSIsIuWPkeeDrSIsMV1dLCJTZWxlY3RlZFZhbHVlQXJyYXkiOltdfSwicDFfVGlXZW4iOnsiVGV4dCI6IjM1LjUifSwicDFfWmFpWGlhbyI6eyJGX0l0ZW1zIjpbWyLkuI3lnKjmoKEiLCLkuI3lnKjmoKEiLDFdLFsi5a6d5bGxIiwi5a6d5bGx5qCh5Yy6IiwxXSxbIuW7tumVvyIsIuW7tumVv+agoeWMuiIsMV0sWyLlmInlrpoiLCLlmInlrprmoKHljLoiLDFdLFsi5paw6Ze46LevIiwi5paw6Ze46Lev5qCh5Yy6IiwxXV0sIlNlbGVjdGVkVmFsdWUiOiLlrp3lsbEifSwicDFfZGRsU2hlbmciOnsiRl9JdGVtcyI6W1siLTEiLCLpgInmi6nnnIHku70iLDEsIiIsIiJdLFsi5YyX5LqsIiwi5YyX5LqsIiwxLCIiLCIiXSxbIuWkqea0pSIsIuWkqea0pSIsMSwiIiwiIl0sWyLkuIrmtbciLCLkuIrmtbciLDEsIiIsIiJdLFsi6YeN5bqGIiwi6YeN5bqGIiwxLCIiLCIiXSxbIuays+WMlyIsIuays+WMlyIsMSwiIiwiIl0sWyLlsbHopb8iLCLlsbHopb8iLDEsIiIsIiJdLFsi6L695a6BIiwi6L695a6BIiwxLCIiLCIiXSxbIuWQieaelyIsIuWQieaelyIsMSwiIiwiIl0sWyLpu5HpvpnmsZ8iLCLpu5HpvpnmsZ8iLDEsIiIsIiJdLFsi5rGf6IuPIiwi5rGf6IuPIiwxLCIiLCIiXSxbIua1meaxnyIsIua1meaxnyIsMSwiIiwiIl0sWyLlronlvr0iLCLlronlvr0iLDEsIiIsIiJdLFsi56aP5bu6Iiwi56aP5bu6IiwxLCIiLCIiXSxbIuaxn+ilvyIsIuaxn+ilvyIsMSwiIiwiIl0sWyLlsbHkuJwiLCLlsbHkuJwiLDEsIiIsIiJdLFsi5rKz5Y2XIiwi5rKz5Y2XIiwxLCIiLCIiXSxbIua5luWMlyIsIua5luWMlyIsMSwiIiwiIl0sWyLmuZbljZciLCLmuZbljZciLDEsIiIsIiJdLFsi5bm/5LicIiwi5bm/5LicIiwxLCIiLCIiXSxbIua1t+WNlyIsIua1t+WNlyIsMSwiIiwiIl0sWyLlm5vlt50iLCLlm5vlt50iLDEsIiIsIiJdLFsi6LS15beeIiwi6LS15beeIiwxLCIiLCIiXSxbIuS6keWNlyIsIuS6keWNlyIsMSwiIiwiIl0sWyLpmZXopb8iLCLpmZXopb8iLDEsIiIsIiJdLFsi55SY6IKDIiwi55SY6IKDIiwxLCIiLCIiXSxbIumdkua1tyIsIumdkua1tyIsMSwiIiwiIl0sWyLlhoXokpnlj6QiLCLlhoXokpnlj6QiLDEsIiIsIiJdLFsi5bm/6KW/Iiwi5bm/6KW/IiwxLCIiLCIiXSxbIuilv+iXjyIsIuilv+iXjyIsMSwiIiwiIl0sWyLlroHlpI8iLCLlroHlpI8iLDEsIiIsIiJdLFsi5paw55aGIiwi5paw55aGIiwxLCIiLCIiXSxbIummmea4ryIsIummmea4ryIsMSwiIiwiIl0sWyLmvrPpl6giLCLmvrPpl6giLDEsIiIsIiJdLFsi5Y+w5rm+Iiwi5Y+w5rm+IiwxLCIiLCIiXV0sIlNlbGVjdGVkVmFsdWVBcnJheSI6WyLkuIrmtbciXX0sInAxX2RkbFNoaSI6eyJFbmFibGVkIjp0cnVlLCJGX0l0ZW1zIjpbWyItMSIsIumAieaLqeW4giIsMSwiIiwiIl0sWyLkuIrmtbfluIIiLCLkuIrmtbfluIIiLDEsIiIsIiJdXSwiU2VsZWN0ZWRWYWx1ZUFycmF5IjpbIuS4iua1t+W4giJdfSwicDFfZGRsWGlhbiI6eyJFbmFibGVkIjp0cnVlLCJGX0l0ZW1zIjpbWyItMSIsIumAieaLqeWOv+WMuiIsMSwiIiwiIl0sWyLpu4TmtabljLoiLCLpu4TmtabljLoiLDEsIiIsIiJdLFsi5Y2i5rm+5Yy6Iiwi5Y2i5rm+5Yy6IiwxLCIiLCIiXSxbIuW+kOaxh+WMuiIsIuW+kOaxh+WMuiIsMSwiIiwiIl0sWyLplb/lroHljLoiLCLplb/lroHljLoiLDEsIiIsIiJdLFsi6Z2Z5a6J5Yy6Iiwi6Z2Z5a6J5Yy6IiwxLCIiLCIiXSxbIuaZrumZgOWMuiIsIuaZrumZgOWMuiIsMSwiIiwiIl0sWyLombnlj6PljLoiLCLombnlj6PljLoiLDEsIiIsIiJdLFsi5p2o5rWm5Yy6Iiwi5p2o5rWm5Yy6IiwxLCIiLCIiXSxbIuWuneWxseWMuiIsIuWuneWxseWMuiIsMSwiIiwiIl0sWyLpl7XooYzljLoiLCLpl7XooYzljLoiLDEsIiIsIiJdLFsi5ZiJ5a6a5Yy6Iiwi5ZiJ5a6a5Yy6IiwxLCIiLCIiXSxbIuadvuaxn+WMuiIsIuadvuaxn+WMuiIsMSwiIiwiIl0sWyLph5HlsbHljLoiLCLph5HlsbHljLoiLDEsIiIsIiJdLFsi6Z2S5rWm5Yy6Iiwi6Z2S5rWm5Yy6IiwxLCIiLCIiXSxbIuWliei0pOWMuiIsIuWliei0pOWMuiIsMSwiIiwiIl0sWyLmtabkuJzmlrDljLoiLCLmtabkuJzmlrDljLoiLDEsIiIsIiJdLFsi5bSH5piO5Yy6Iiwi5bSH5piO5Yy6IiwxLCIiLCIiXV0sIlNlbGVjdGVkVmFsdWVBcnJheSI6WyLlrp3lsbHljLoiXX0sInAxX0ZlbmdYRFFETCI6eyJMYWJlbCI6IjEy5pyIMDTml6Xoh7MxMuaciDE45pel5piv5ZCm5Zyo5Lit6auY6aOO6Zmp5Zyw5Yy66YCX55WZPHNwYW4gc3R5bGU9J2NvbG9yOnJlZDsnPu+8iOWGheiSmeWPpOa7oea0sumHjOS4nOWxseihl+mBk+OAgeWMl+WMuuihl+mBk+WKnuS6i+WkhO+8jOaJjui1ieivuuWwlOWMuuesrOS4ieOAgeesrOWbm+OAgeesrOS6lOihl+mBk+WKnuS6i+WkhO+8jOaIkOmDveW4gumDq+mDveWMuumDq+etkuihl+mBk+WkquW5s+adkeOAgeiPoOiQneekvuWMuuS4remTgeWlpee7tOWwlOS6jOacn+OAgeS4ieacn+OAgemDq+mDveWMuuWUkOaYjOmVh+awuOWuieadkTjnu4TjgIHmiJDljY7ljLrltJTlrrblupfljY7pg73kupHmma/lj7DlsI/ljLrvvIzpu5HpvpnmsZ/niaHkuLnmsZ/luILkuJzlroHluILkuK3lv4PnpL7ljLrjgIHnu6XoiqzmsrPluILpnZLkupHlsI/ljLrvvIzmlrDnloblkJDpsoHnlarluILnuqLnm77lsI/ljLrvvIk8L3NwYW4+IiwiRl9JdGVtcyI6W1si5pivIiwi5pivIiwxXSxbIuWQpiIsIuWQpiIsMV1dLCJTZWxlY3RlZFZhbHVlIjpudWxsfSwicDFfVG9uZ1pXRExIIjp7IkxhYmVsIjoi5LiK5rW35ZCM5L2P5Lq65ZGY5piv5ZCm5pyJMTLmnIgwNOaXpeiHszEy5pyIMTjml6XmnaXoh6rkuK3pq5jpo47pmanlnLDljLrnmoTkuro8c3BhbiBzdHlsZT0nY29sb3I6cmVkOyc+77yI5YaF6JKZ5Y+k5ruh5rSy6YeM5Lic5bGx6KGX6YGT44CB5YyX5Yy66KGX6YGT5Yqe5LqL5aSE77yMF_STATE5omO6LWJ6K+65bCU5Yy656ys5LiJ44CB56ys5Zub44CB56ys5LqU6KGX6YGT5Yqe5LqL5aSE77yM5oiQ6YO95biC6YOr6YO95Yy66YOr562S6KGX6YGT5aSq5bmz5p2R44CB6I+g6JCd56S+5Yy65Lit6ZOB5aWl57u05bCU5LqM5pyf44CB5LiJ5pyf44CB6YOr6YO95Yy65ZSQ5piM6ZWH5rC45a6J5p2ROOe7hOOAgeaIkOWNjuWMuuW0lOWutuW6l+WNjumDveS6keaZr+WPsOWwj+WMuu+8jOm7kem+meaxn+eJoeS4ueaxn+W4guS4nOWugeW4guS4reW/g+ekvuWMuuOAgee7peiKrOays+W4gumdkuS6keWwj+WMuu+8jOaWsOeWhuWQkOmygeeVquW4gue6ouebvuWwj+WMuu+8iTwvc3Bhbj4iLCJGX0l0ZW1zIjpbWyLmmK8iLCLmmK8iLDFdLFsi5ZCmIiwi5ZCmIiwxXV0sIlNlbGVjdGVkVmFsdWUiOm51bGx9LCJwMV9YaWFuZ1hEWiI6eyJUZXh0Ijoi5paw5qCh5Yy65qCh5YaFTiJ9LCJwMV9RdWVaSFpKQyI6eyJGX0l0ZW1zIjpbWyLmmK8iLCLmmK8iLDEsIiIsIiJdLFsi5ZCmIiwi5ZCmIiwxLCIiLCIiXV0sIlNlbGVjdGVkVmFsdWVBcnJheSI6WyLlkKYiXX0sInAxX0RhbmdSR0wiOnsiU2VsZWN0ZWRWYWx1ZSI6IuWQpiIsIkZfSXRlbXMiOltbIuaYryIsIuaYryIsMV0sWyLlkKYiLCLlkKYiLDFdXX0sInAxX0dlTFNNIjp7IkhpZGRlbiI6dHJ1ZSwiSUZyYW1lQXR0cmlidXRlcyI6e319LCJwMV9HZUxGUyI6eyJSZXF1aXJlZCI6ZmFsc2UsIkhpZGRlbiI6dHJ1ZSwiRl9JdGVtcyI6W1si5bGF5a626ZqU56a7Iiwi5bGF5a626ZqU56a7IiwxXSxbIumbhuS4remalOemuyIsIumbhuS4remalOemuyIsMV1dLCJTZWxlY3RlZFZhbHVlIjpudWxsfSwicDFfR2VMRFoiOnsiSGlkZGVuIjp0cnVlfSwicDFfQ2VuZ0ZXSCI6eyJMYWJlbCI6IjEy5pyIMDTml6Xoh7MxMuaciDE45pel5piv5ZCm5Zyo5Lit6auY6aOO6Zmp5Zyw5Yy66YCX55WZ6L+HPHNwYW4gc3R5bGU9J2NvbG9yOnJlZDsnPu+8iOWGheiSmeWPpOa7oea0sumHjOS4nOWxseihl+mBk+OAgeWMl+WMuuihl+mBk+WKnuS6i+WkhO+8jOaJjui1ieivuuWwlOWMuuesrOS4ieOAgeesrOWbm+OAgeesrOS6lOihl+mBk+WKnuS6i+WkhO+8jOaIkOmDveW4gumDq+mDveWMuumDq+etkuihl+mBk+WkquW5s+adkeOAgeiPoOiQneekvuWMuuS4remTgeWlpee7tOWwlOS6jOacn+OAgeS4ieacn+OAgemDq+mDveWMuuWUkOaYjOmVh+awuOWuieadkTjnu4TjgIHmiJDljY7ljLrltJTlrrblupfljY7pg73kupHmma/lj7DlsI/ljLrvvIzpu5HpvpnmsZ/niaHkuLnmsZ/luILkuJzlroHluILkuK3lv4PnpL7ljLrjgIHnu6XoiqzmsrPluILpnZLkupHlsI/ljLrvvIzmlrDnloblkJDpsoHnlarluILnuqLnm77lsI/ljLrvvIk8L3NwYW4+IiwiRl9JdGVtcyI6W1si5pivIiwi5pivIiwxXSxbIuWQpiIsIuWQpiIsMV1dLCJTZWxlY3RlZFZhbHVlIjoi5ZCmIn0sInAxX0NlbmdGV0hfUmlRaSI6eyJIaWRkZW4iOnRydWV9LCJwMV9DZW5nRldIX0JlaVpodSI6eyJIaWRkZW4iOnRydWV9LCJwMV9KaWVDaHUiOnsiTGFiZWwiOiIxMuaciDA05pel6IezMTLmnIgxOOaXpeaYr+WQpuS4juadpeiHquS4remrmOmjjumZqeWcsOWMuuWPkeeDreS6uuWRmOWvhuWIh+aOpeinpjxzcGFuIHN0eWxlPSdjb2xvcjpyZWQ7Jz7vvIjlhoXokpnlj6Tmu6HmtLLph4zkuJzlsbHooZfpgZPjgIHljJfljLrooZfpgZPlip7kuovlpITvvIzmiY7otYnor7rlsJTljLrnrKzkuInjgIHnrKzlm5vjgIHnrKzkupTooZfpgZPlip7kuovlpITvvIzmiJDpg73luILpg6vpg73ljLrpg6vnrZLooZfpgZPlpKrlubPmnZHjgIHoj6DokJ3npL7ljLrkuK3pk4HlpaXnu7TlsJTkuozmnJ/jgIHkuInmnJ/jgIHpg6vpg73ljLrllJDmmIzplYfmsLjlronmnZE457uE44CB5oiQ5Y2O5Yy65bSU5a625bqX5Y2O6YO95LqR5pmv5Y+w5bCP5Yy677yM6buR6b6Z5rGf54mh5Li55rGf5biC5Lic5a6B5biC5Lit5b+D56S+5Yy644CB57ul6Iqs5rKz5biC6Z2S5LqR5bCP5Yy677yM5paw55aG5ZCQ6bKB55Wq5biC57qi55u+5bCP5Yy677yJPC9zcGFuPiIsIkZfSXRlbXMiOltbIuaYryIsIuaYryIsMV0sWyLlkKYiLCLlkKYiLDFdXSwiU2VsZWN0ZWRWYWx1ZSI6IuWQpiJ9LCJwMV9KaWVDaHVfUmlRaSI6eyJIaWRkZW4iOnRydWV9LCJwMV9KaWVDaHVfQmVpWmh1Ijp7IkhpZGRlbiI6dHJ1ZX0sInAxX1R1SldIIjp7IkxhYmVsIjoiMTLmnIgwNOaXpeiHszEy5pyIMTjml6XmmK/lkKbkuZjlnZDlhazlhbHkuqTpgJrpgJTlvoTkuK3pq5jpo47pmanlnLDljLo8c3BhbiBzdHlsZT0nY29sb3I6cmVkOyc+77yI5YaF6JKZ5Y+k5ruh5rSy6YeM5Lic5bGx6KGX6YGT44CB5YyX5Yy66KGX6YGT5Yqe5LqL5aSE77yM5omO6LWJ6K+65bCU5Yy656ys5LiJ44CB56ys5Zub44CB56ys5LqU6KGX6YGT5Yqe5LqL5aSE77yM5oiQ6YO95biC6YOr6YO95Yy66YOr562S6KGX6YGT5aSq5bmz5p2R44CB6I+g6JCd56S+5Yy65Lit6ZOB5aWl57u05bCU5LqM5pyf44CB5LiJ5pyf44CB6YOr6YO95Yy65ZSQ5piM6ZWH5rC45a6J5p2ROOe7hOOAgeaIkOWNjuWMuuW0lOWutuW6l+WNjumDveS6keaZr+WPsOWwj+WMuu+8jOm7kem+meaxn+eJoeS4ueaxn+W4guS4nOWugeW4guS4reW/g+ekvuWMuuOAgee7peiKrOays+W4gumdkuS6keWwj+WMuu+8jOaWsOeWhuWQkOmygeeVquW4gue6ouebvuWwj+WMuu+8iTwvc3Bhbj4iLCJGX0l0ZW1zIjpbWyLmmK8iLCLmmK8iLDFdLFsi5ZCmIiwi5ZCmIiwxXV0sIlNlbGVjdGVkVmFsdWUiOiLlkKYifSwicDFfVHVKV0hfUmlRaSI6eyJIaWRkZW4iOnRydWV9LCJwMV9UdUpXSF9CZWlaaHUiOnsiSGlkZGVuIjp0cnVlfSwicDFfSmlhUmVuIjp7IkxhYmVsIjoiMTLmnIgwNOaXpeiHszEy5pyIMTjml6XlrrbkurrmmK/lkKbmnInlj5Hng63nrYnnl4fnirYifSwicDFfSmlhUmVuX0JlaVpodSI6eyJIaWRkZW4iOnRydWV9LCJwMV9TdWlTTSI6eyJTZWxlY3RlZFZhbHVlIjoi57u/6ImyIiwiRl9JdGVtcyI6W1si57qi6ImyIiwi57qi6ImyIiwxXSxbIum7hOiJsiIsIum7hOiJsiIsMV0sWyLnu7/oibIiLCLnu7/oibIiLDFdXX0sInAxX0x2TWExNERheXMiOnsiU2VsZWN0ZWRWYWx1ZSI6IuaYryIsIkZfSXRlbXMiOltbIuaYryIsIuaYryIsMV0sWyLlkKYiLCLlkKYiLDFdXX0sInAxIjp7IlRpdGxlIjoi5q+P5pel5Lik5oql77yI5LiK5Y2I77yJIiwiSUZyYW1lQXR0cmlidXRlcyI6e319fQ=='
}
morn_rep_responce = session.post(url=morn_rep_url, headers=headers, data=morn_rep_data)
print(morn_rep_responce.status_code)
